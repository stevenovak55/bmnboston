/**
 * Mobile Fullscreen Styles
 * Creates app-like fullscreen experience on mobile devices
 *
 * @package MLS_Listings_Display
 * @since 6.11.17
 */

/* CSS Pseudo-fullscreen mode (iOS + fallback) */
body.mld-fullscreen-mode {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    height: 100% !important;
    overflow: hidden !important;
    /* Account for iOS safe areas */
    padding-top: env(safe-area-inset-top, 0) !important;
    padding-bottom: env(safe-area-inset-bottom, 0) !important;
    padding-left: env(safe-area-inset-left, 0) !important;
    padding-right: env(safe-area-inset-right, 0) !important;
}

body.mld-fullscreen-mode > .mld-mobile-property,
body.mld-fullscreen-mode > .mld-search-container,
body.mld-fullscreen-mode > #mld-half-map-container,
body.mld-fullscreen-mode > #mld-full-map-container,
body.mld-fullscreen-mode .mld-mobile-property,
body.mld-fullscreen-mode .mld-search-container,
body.mld-fullscreen-mode #mld-half-map-container,
body.mld-fullscreen-mode #mld-full-map-container {
    height: 100vh !important;
    height: 100dvh !important; /* Dynamic viewport height for mobile */
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

/* Exit fullscreen button - Bottom left */
.mld-fullscreen-exit-btn {
    position: fixed !important;
    bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
    left: 10px;
    z-index: 999999 !important;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.6);
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
}

.mld-fullscreen-exit-btn:hover,
.mld-fullscreen-exit-btn:active {
    background: rgba(0, 0, 0, 0.8);
    transform: scale(1.05);
}

.mld-fullscreen-exit-btn svg {
    width: 20px;
    height: 20px;
}

/* Enable fullscreen button (when disabled) - Bottom left */
.mld-fullscreen-enable-btn {
    position: fixed !important;
    bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
    left: 10px;
    z-index: 999999 !important;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(8, 145, 178, 0.9); /* Teal */
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease;
}

.mld-fullscreen-enable-btn:hover,
.mld-fullscreen-enable-btn:active {
    background: rgba(14, 116, 144, 1); /* Darker teal */
    transform: scale(1.05);
}

.mld-fullscreen-enable-btn svg {
    width: 20px;
    height: 20px;
}

/* Hide buttons on desktop */
@media (min-width: 769px) {
    .mld-fullscreen-exit-btn,
    .mld-fullscreen-enable-btn {
        display: none !important;
    }
}

/* Ensure content is scrollable in fullscreen */
body.mld-fullscreen-mode .mld-bottom-sheet {
    max-height: calc(100dvh - 60px) !important;
}

/* Mobile property page specific */
body.mld-fullscreen-mode .mld-mobile-property-container {
    height: 100dvh !important;
    overflow-y: auto !important;
}

/* v6.25.14: Property pages should NOT use CSS fullscreen mode at all.
 * The JS handler skips CSS changes on property pages, but if the class
 * somehow gets added, these rules prevent it from breaking the layout.
 * Key fix: Remove the padding that breaks absolute/fixed positioning. */
body.mld-property-mobile-v3.mld-fullscreen-mode {
    /* Override the problematic padding that breaks gallery positioning */
    padding: 0 !important;
    padding-top: 0 !important;
    padding-bottom: 0 !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
}

/* Ensure gallery container maintains proper positioning */
body.mld-fullscreen-mode.mld-property-mobile-v3 .mld-gallery-container,
body.mld-fullscreen-mode.mld-property-mobile-v3 #gallery {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: 1 !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
}

body.mld-fullscreen-mode.mld-property-mobile-v3 .mld-gallery-scroll {
    visibility: visible !important;
    opacity: 1 !important;
}

body.mld-fullscreen-mode.mld-property-mobile-v3 .mld-photo-item,
body.mld-fullscreen-mode.mld-property-mobile-v3 .mld-photo-item img {
    visibility: visible !important;
    opacity: 1 !important;
}

/* Half-map search specific */
body.mld-fullscreen-mode .mld-half-map-wrapper {
    height: 100dvh !important;
}

/* Full-map search specific */
body.mld-fullscreen-mode .mld-full-map-wrapper {
    height: 100dvh !important;
}
