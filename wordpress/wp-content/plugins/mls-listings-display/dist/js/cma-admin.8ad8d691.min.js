(self.webpackChunkmls_listings_display=self.webpackChunkmls_listings_display||[]).push([[694],{360:function(e,a,s){s(692)(document).ready(function(e){e("#mld-market-calculator-form").on("submit",function(a){a.preventDefault();var s=e(this),t=e("#market-calculator-results"),r=e("#market-calculator-data"),n=s.find('button[type="submit"]');n.prop("disabled",!0).text("Calculating..."),t.hide(),e.ajax({url:mldCmaAdmin.ajaxurl,type:"POST",data:{action:"mld_get_market_adjustments",nonce:mldCmaAdmin.nonce,city:s.find('[name="city"]').val(),state:s.find('[name="state"]').val(),property_type:s.find('[name="property_type"]').val(),months:s.find('[name="months"]').val()},success:function(e){if(e.success){var a="",s=e.data.adjustments;for(var n in s){var o=s[n],l="";l="number"==typeof o?"$"+o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):o||"(no data)",a+='<div class="mld-adjustment-item">',a+='<span class="mld-adjustment-label">'+n.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())+":</span>",a+='<span class="mld-adjustment-value">'+l+"</span>",a+="</div>"}r.html(a),t.show().removeClass("error").addClass("success")}else r.html('<p class="error">'+e.data+"</p>"),t.show().removeClass("success").addClass("error")},error:function(){r.html('<p class="error">An error occurred. Please try again.</p>'),t.show().removeClass("success").addClass("error")},complete:function(){n.prop("disabled",!1).text("Calculate Market Data")}})}),e("#mld-adjustment-overrides-form").on("submit",function(a){a.preventDefault();var s=e(this),t=e("#overrides-save-message"),r=s.find('button[type="submit"]');r.prop("disabled",!0).text("Saving..."),t.hide(),e.ajax({url:mldCmaAdmin.ajaxurl,type:"POST",data:{action:"mld_save_adjustment_overrides",nonce:mldCmaAdmin.nonce,price_per_sqft:s.find('[name="price_per_sqft"]').val(),garage_first:s.find('[name="garage_first"]').val(),garage_additional:s.find('[name="garage_additional"]').val(),pool:s.find('[name="pool"]').val(),bedroom:s.find('[name="bedroom"]').val(),bathroom:s.find('[name="bathroom"]').val(),waterfront:s.find('[name="waterfront"]').val(),year_built_rate:s.find('[name="year_built_rate"]').val(),location_rate:s.find('[name="location_rate"]').val(),road_type_discount:s.find('[name="road_type_discount"]').val()},success:function(e){e.success?(t.html("<p><strong>✓ "+e.data.message+"</strong></p>"),t.show().removeClass("error").addClass("success")):(t.html("<p><strong>✗ Error:</strong> "+e.data+"</p>"),t.show().removeClass("success").addClass("error"))},error:function(){t.html("<p><strong>✗ Error:</strong> An error occurred. Please try again.</p>"),t.show().removeClass("success").addClass("error")},complete:function(){r.prop("disabled",!1).text("Save Overrides")}})}),e("#reset-overrides-btn").on("click",function(){if(confirm("Reset all overrides to auto-calculated values?")){var a=e(this),s=e("#overrides-save-message");a.prop("disabled",!0).text("Resetting..."),s.hide(),e.ajax({url:mldCmaAdmin.ajaxurl,type:"POST",data:{action:"mld_reset_adjustment_overrides",nonce:mldCmaAdmin.nonce},success:function(a){a.success?(e("#mld-adjustment-overrides-form").find('input[type="number"]').each(function(){"road_type_discount"===e(this).attr("name")?e(this).val("25"):e(this).val("")}),s.html("<p><strong>✓ "+a.data.message+"</strong></p>"),s.show().removeClass("error").addClass("success")):(s.html("<p><strong>✗ Error:</strong> "+a.data+"</p>"),s.show().removeClass("success").addClass("error"))},error:function(){s.html("<p><strong>✗ Error:</strong> An error occurred. Please try again.</p>"),s.show().removeClass("success").addClass("error")},complete:function(){a.prop("disabled",!1).text("Reset to Auto-Calculated")}})}}),e("#mld-test-email-form").on("submit",function(a){a.preventDefault();var s=e(this),t=e("#test-email-results"),r=s.find('button[type="submit"]');r.prop("disabled",!0).text("Sending..."),t.hide(),e.ajax({url:mldCmaAdmin.ajaxurl,type:"POST",data:{action:"mld_test_cma_email",nonce:mldCmaAdmin.nonce,email:s.find('[name="email"]').val(),listing_id:s.find('[name="listing_id"]').val()},success:function(e){if(e.success)t.html("<p><strong>✓ Email sent successfully!</strong></p><p>"+e.data.message+"</p>"),t.show().removeClass("error").addClass("success");else{var a="object"==typeof e.data&&e.data.message?e.data.message:"string"==typeof e.data?e.data:"Unknown error";t.html("<p><strong>✗ Email failed:</strong> "+a+"</p>"),t.show().removeClass("success").addClass("error")}},error:function(e,a,s){t.html("<p><strong>✗ Error "+e.status+":</strong> "+e.statusText+"</p><pre>"+e.responseText.substring(0,500)+"</pre>"),t.show().removeClass("success").addClass("error")},complete:function(){r.prop("disabled",!1).text("Send Test Email")}})})})}},function(e){e.O(0,[96],function(){return a=360,e(e.s=a);var a});e.O()}]);
//# sourceMappingURL=cma-admin.8ad8d691.min.js.map